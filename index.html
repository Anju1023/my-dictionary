<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>はじめてのDictionary</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai-sublime.min.css"
    />
    <script
      src="https://kit.fontawesome.com/768bdb2b98.js"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <header class="header">
      <div class="container">
        <div class="header_left">
          <h1>
            はじめての<span id="dic">Dictionary</span
            ><span><i class="fa-solid fa-book-open"></i></span>
          </h1>
        </div>
        <div class="header_right">
          <a href="#page-top"><i class="fa-solid fa-circle-up"></i></a>
        </div>
      </div>
    </header>
    <main class="main">
      <section class="explain" id="page-top">
        <div class="container">
          <h2>Dictionaryってなに？</h2>
          <p>
            データとキーをセットで格納するオブジェクトのこと。<br />
            辞書のようなもので、<span>連想配列</span>とも呼ばれています。
          </p>
          <p>
            配列はインデックス番号と要素の値がセットなのに対して、連想配列は<span>キー(Key)</span>と<span>データ(Item)</span>がセットになります。
          </p>
          <p>
            キーは文字列でも数値でもOK！<br />
            でも重複は絶対NG！！
          </p>
        </div>
      </section>
      <section class="how-to">
        <div class="container">
          <h2>Dictionaryの使い方</h2>
          <div class="how-to_dim">
            <h3>
              <span><i class="fa-solid fa-pencil"></i></span>宣言
            </h3>
            <p>まずは、変数名を決め、<span>Object型</span>で宣言します。</p>
            <p>
              オブジェクトなので、変数にセットするときは<span>Set</span>を付けます。
            </p>
            <p>
              変数には<span>CreateObject("Scripting.Dictionary")</span>と書きます。これは呪文のようなものなので覚えましょう！
            </p>
            <div class="code-block">
              <button class="copy-btn" onclick="copyCode(this)">
                <i class="fa-solid fa-copy"></i>
              </button>
              <pre>
                <code id="dim" class="vbnet">
                  Dim 変数名 As Object
                  Set 変数名 = CreateObject("Scripting.Dictionary")
                </code>
              </pre>
            </div>
          </div>
          <div class="how-to_method">
            <h3>
              <span><i class="fa-solid fa-pencil"></i></span>メソッド
            </h3>
            <p>メソッドにはいくつか種類があるので覚えましょう！</p>
            <div class="how-to_method_add">
              <h4>Addメソッドを使って要素を追加していく</h4>
              <p>
                Addメソッドを使うと、キーとアイテムを追加することができます。
              </p>
              <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fa-solid fa-copy"></i>
                </button>
                <pre>
                  <code class="vbnet">
                    変数名.Add Key,Item
                  </code>
                </pre>
              </div>
              <p>試しに、フルーツの名前と値段を追加していきましょう！</p>
              <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fa-solid fa-copy"></i>
                </button>
                <pre>
                  <code id="addEx" class="vbnet">
Sub フルーツDictionary()
    Dim Fruits As Object
    Set Fruits = CreateObject("Scripting.Dictionary")

    Fruits.Add "りんご", 100
    Fruits.Add "みかん", 130
    Fruits.Add "メロン", 300
End Sub
                </code>
                </pre>
              </div>
              <p>
                これで、フルーツの名前をキーに、値段をアイテムとしてディクショナリに追加することができました！
              </p>
              <p>
                今はアイテムがひとつですが、複数設定することもできます。<br />
                複数のアイテムを設定する場合は、<span>Array関数</span>を使います。
              </p>
              <p>
                下のコードでは、フルーツの値段に加えて、個数も追加しています。
              </p>
              <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fa-solid fa-copy"></i>
                </button>
                <pre>
                  <code id="addEx2" class="vbnet">
                    Sub フルーツDictionary()
                        Dim Fruits As Object
                        Set Fruits = CreateObject("Scripting.Dictionary")
                
                        Fruits.Add "りんご", Array(100, 3) '←Arrayを使って複数アイテムを追加！
                        Fruits.Add "みかん", Array(130, 5)
                        Fruits.Add "メロン", Array(300, 2)
                    End Sub
                  </code>
                </pre>
              </div>
              <p>
                すると、フルーツの名前をキーに、複数のアイテムを追加することができました！
              </p>
            </div>
            <div class="how-to_method_keys">
              <h4>Keysメソッドを使ってキーのリストを取得する</h4>
              <p>Keysメソッドを使うと、キーのリストが配列で取得できます。</p>
              <p>
                先ほど追加した三つのフルーツリストをイミディエイトウィンドウに出力してみましょう
              </p>
              <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fa-solid fa-copy"></i>
                </button>
                <pre>
                  <code id="keysEx" class="vbnet">
                        Dim i As Long, FruitsList As Variant
                        FruitsList = Fruits.Keys
                
                        For i = LBound(FruitsList) To UBound(FruitsList)
                            Debug.Print FruitsList(i)
                        Next i
                  </code>
                </pre>
              </div>
              <p>イミディエイトウィンドウを確認してみると、、、？</p>
              <pre>
                <code id="keysExPrint" class="vbnet">
                  りんご
                  みかん
                  メロン
                </code>
              </pre>
              <p>無事にフルーツリストが出力されました！</p>
            </div>
            <div class="how-to_method_foreach">
              <h4>For Eachを使ってみよう</h4>
              <p>ここでちょっと番外編！</p>
              <p>
                今までループにはFor
                Nextステートメントを使ってきましたが、Dictionaryを扱うならもっと相性のいいループ形式があります。
              </p>
              <p>
                For
                Eachステートメントは、配列やコレクションなどのグループの各要素に対して繰り返し処理を行うループ形式です。
              </p>
              <p>以下のようにVariant型の変数を用意して、ループしていきます。</p>
              <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fa-solid fa-copy"></i>
                </button>
                <pre>
                  <code id="foreachHowto" class="vbnet">
                        Dim キー As Variant
                        For Each キー In 配列やオブジェクト
                            処理
                        Next キー
                  </code>
                </pre>
              </div>
              <p>
                今回のように、フルーツリストをひとつずつイミディエイトウィンドウに出力していく場合は、以下のように記述します。
              </p>
              <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fa-solid fa-copy"></i>
                </button>
                <pre>
                  <code id="foreachEx" class="vbnet">
                        Dim k As Variant, FruitsList As Variant
                        FruitsList = Fruits.Keys
                
                        For Each k In FruitsList
                            Debug.Print k
                        Next k
                  </code>
                </pre>
              </div>
            </div>
            <div class="how-to_method_exists">
              <h4>Existsメソッドを使って条件分岐式を作ろう</h4>
              <p>
                Existsメソッドを使うと、指定したキーが存在するかどうかを返すことができます。
              </p>
              <p>
                実務では、指定したキーが存在しなければDictionaryに要素を追加するなど、重複データに対応することができます。
              </p>
              <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fa-solid fa-copy"></i>
                </button>
                <pre>
                  <code id="exists" class="vbnet">
                    Sub パンDictionary()
                        Dim ws As Worksheet
                        Dim Pans As Object
                        Set ws = Worksheets("売上")
                        Set Pans = CreateObject("Scripting.Dictionary")
                
                        Dim panName As String, panPrice As Long, panQty As Long
                        Dim lastRow As Long, i As Long
                        With ws
                            lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row
                
                            For i = 2 To lastRow
                                panName = .Cells(i, 1).Value
                                panPrice = .Cells(i, 2).Value
                                panQty = .Cells(i, 3).Value
                
                                If Not Pans.Exists(panName) Then
                                    Pans.Add panName, Array(panPrice, panQty)
                                End If
                            Next i
                        End With
                    End Sub
                  </code>
                </pre>
              </div>
              <p>
                これで、シート"売上"にあるデータをDictionaryに追加することができました！
              </p>
            </div>
          </div>
          <div class="how-to_property">
            <h3>
              <span><i class="fa-solid fa-pencil"></i></span>プロパティ
            </h3>
            <p>プロパティの中でもよく使うものをまとめました！</p>
            <div class="how-to_property_item">
              <h4>Keyを使ってItemを取得しよう</h4>
              <p>
                Keyに対する中身のItemを知りたいときは、<span>Dictionaryの変数名(Key)</span>と記述します。
              </p>
              <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fa-solid fa-copy"></i>
                </button>
                <pre>
                  <code id="item" class="vbnet">
                    Dim k As Variant, PansList As Variant
                    PansList = Pans.Keys
                
                    For Each k In PansList
                        Debug.Print k, Pans(k)(0), Pans(k)(1)
                    Next k
                  </code>
                </pre>
              </div>
              <p>
                Itemが複数だった場合、中身は配列になっているので、インデックス番号を使って表します。
              </p>
              <p>
                今回の場合はPans(k)がItemリストを表しているので、Pans(k)(0)、Pans(k)(1)と記述することでItemひとつひとつを取り出すことができます。
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>
    <footer class="footer">
      <div class="container">
        <p>侑太がんばろおお！！！！</p>
      </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
      hljs.highlightAll();
    </script>
    <script src="js/script.js"></script>
  </body>
</html>
